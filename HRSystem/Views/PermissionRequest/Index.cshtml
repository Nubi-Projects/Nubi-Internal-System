@model IEnumerable<HRSystem.Models.PermissionRequest>
@using Microsoft.AspNet.Identity
@{
    ViewBag.Title = "Index";
    HRSystem.Manager.RequestManager mngr = new HRSystem.Manager.RequestManager();
    HRSystem.Manager.Helper helperx = new HRSystem.Manager.Helper();
}

<h2>@Resources.NubiHR.Permissions</h2>

 

@if (ViewBag.per)
{
    <a href="@Url.Action("Create","PermissionRequest")" class="btn btn-primary">@Resources.NubiHR.Create</a>
}
else
{
    <a href="@Url.Action("Create","PermissionRequest")" class="btn btn-primary disabled">@Resources.NubiHR.Create</a>
}

<br />
<nav>
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-all" role="tab" aria-controls="nav-all" aria-selected="true">@Resources.NubiHR.AllRequests</a>
        <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-approved" role="tab" aria-controls="nav-approved" aria-selected="false">@Resources.NubiHR.ApprovedRequests</a>
        <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-rejected" role="tab" aria-controls="nav-rejected" aria-selected="false">@Resources.NubiHR.RejectedRequests</a>
    </div>
</nav>
<div class="tab-content" id="nav-tabContent">
    <div class="tab-pane fade show active" id="nav-all" role="tabpanel" aria-labelledby="nav-home-tab">
        <br />
        <table id="assets-data-table" class="table table-striped table-bordered ">

            @if (User.Identity.GetUserId() != null)
            {
                if (@helperx.GetUserRole(User.Identity.GetUserId()) == "المدير العام")
                {
                    <thead>
                        <tr>
                            <th>
                                @Resources.NubiHR.EmployeeName
                            </th>
                            <th>
                                @Resources.NubiHR.RequestDate
                            </th>
                            <th>
                                @Resources.NubiHR.TimeFrom
                            </th>

                            <th>
                                @Resources.NubiHR.TimeTo
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionDate
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionType
                            </th>

                            <th>
                                @Resources.NubiHR.Notes
                            </th>

                            @*<th>
                                @Resources.NubiHR.Status
                            </th>*@

                            <th>
                                @Resources.NubiHR.Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Where(e => e.IsDeleted == false).ToList())
                        {
                            <tr onclick="Edit('@item.Id')">
                                <td>
                                    @Html.DisplayFor(modelItem => item.Employee.FirstName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.RequestDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeFromHours) : @Html.DisplayFor(modelItem => item.TimeFromMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeToHours) : @Html.DisplayFor(modelItem => item.TimeToMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionType.Type)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.Note)
                                </td>

                                @*<td>
                                    @Html.DisplayFor(modelItem => item.IsRejected)
                                </td>*@

                                <td>
                                    @*@Html.ActionLink(Resources.NubiHR.Edit, "Edit", new { id = item.Id }) |*@
                                    @Html.ActionLink(Resources.NubiHR.Details, "Details", new { id = item.Id })
                                </td>
                            </tr>
                        }
                    </tbody>
                }
                else
                {
                    <thead>
                        <tr>
                            <th>
                                @Resources.NubiHR.EmployeeName
                            </th>
                            <th>
                                @Resources.NubiHR.RequestDate
                            </th>
                            <th>
                                @Resources.NubiHR.TimeFrom
                            </th>

                            <th>
                                @Resources.NubiHR.TimeTo
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionDate
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionType
                            </th>

                            <th>
                                @Resources.NubiHR.Notes
                            </th>

                            <th>
                                @Resources.NubiHR.Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Where(e => e.IsDeleted == false && e.EmployeeNo == helperx.GetName(User.Identity.GetUserId()).Employee.Id).ToList())
                        {
                            <tr onclick="Edit('@item.Id')">
                                <td>
                                    @Html.DisplayFor(modelItem => item.Employee.FirstName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.RequestDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeFromHours) : @Html.DisplayFor(modelItem => item.TimeFromMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeToHours) : @Html.DisplayFor(modelItem => item.TimeToMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionType.Type)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.Note)
                                </td>

                                <td>
                                    @*@Html.ActionLink(Resources.NubiHR.Edit, "Edit", new { id = item.Id }) |*@
                                    @Html.ActionLink(Resources.NubiHR.Details, "Details", new { id = item.Id })
                                </td>
                            </tr>
                        }
                    </tbody>
                }
            }
        </table>
    </div>
    <div class="tab-pane fade" id="nav-approved" role="tabpanel" aria-labelledby="nav-profile-tab">
        <br />
        <table id="assets-data-table1" class="table table-striped table-bordered ">

            @if (User.Identity.GetUserId() != null)
            {
                if (@helperx.GetUserRole(User.Identity.GetUserId()) == "المدير العام")
                {
                    <thead>
                        <tr>
                            <th>
                                @Resources.NubiHR.EmployeeName
                            </th>
                            <th>
                                @Resources.NubiHR.RequestDate
                            </th>
                            <th>
                                @Resources.NubiHR.TimeFrom
                            </th>

                            <th>
                                @Resources.NubiHR.TimeTo
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionDate
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionType
                            </th>

                            <th>
                                @Resources.NubiHR.Notes
                            </th>

                            @*<th>
                                @Resources.NubiHR.Status
                            </th>*@

                            <th>
                                @Resources.NubiHR.Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Where(e => e.IsDeleted == false && e.ManagerApprovement == true).ToList())
                        {
                            <tr onclick="Edit('@item.Id')">
                                <td>
                                    @Html.DisplayFor(modelItem => item.Employee.FirstName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.RequestDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeFromHours) : @Html.DisplayFor(modelItem => item.TimeFromMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeToHours) : @Html.DisplayFor(modelItem => item.TimeToMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionType.Type)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.Note)
                                </td>

                                @*<td>
                                    @Html.DisplayFor(modelItem => item.IsRejected)
                                </td>*@

                                <td>
                                    @*@Html.ActionLink(Resources.NubiHR.Edit, "Edit", new { id = item.Id }) |*@
                                    @Html.ActionLink(Resources.NubiHR.Details, "Details", new { id = item.Id })
                                </td>
                            </tr>
                        }
                    </tbody>
                }
                else
                {
                    <thead>
                        <tr>
                            <th>
                                @Resources.NubiHR.EmployeeName
                            </th>
                            <th>
                                @Resources.NubiHR.RequestDate
                            </th>
                            <th>
                                @Resources.NubiHR.TimeFrom
                            </th>

                            <th>
                                @Resources.NubiHR.TimeTo
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionDate
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionType
                            </th>

                            <th>
                                @Resources.NubiHR.Notes
                            </th>

                            <th>
                                @Resources.NubiHR.Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Where(e => e.IsDeleted == false && e.EmployeeNo == helperx.GetName(User.Identity.GetUserId()).Employee.Id && e.ManagerApprovement == true).ToList())
                        {
                            <tr onclick="Edit('@item.Id')">
                                <td>
                                    @Html.DisplayFor(modelItem => item.Employee.FirstName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.RequestDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeFromHours) : @Html.DisplayFor(modelItem => item.TimeFromMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeToHours) : @Html.DisplayFor(modelItem => item.TimeToMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionType.Type)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.Note)
                                </td>

                                <td>
                                    @*@Html.ActionLink(Resources.NubiHR.Edit, "Edit", new { id = item.Id }) |*@
                                    @Html.ActionLink(Resources.NubiHR.Details, "Details", new { id = item.Id })
                                </td>
                            </tr>
                        }
                    </tbody>
                }
            }
        </table>
    </div>
    <div class="tab-pane fade" id="nav-rejected" role="tabpanel" aria-labelledby="nav-contact-tab">
        <br />
        <table id="assets-data-table2" class="table table-striped table-bordered ">

            @if (User.Identity.GetUserId() != null)
            {
                if (@helperx.GetUserRole(User.Identity.GetUserId()) == "المدير العام")
                {
                    <thead>
                        <tr>
                            <th>
                                @Resources.NubiHR.EmployeeName
                            </th>
                            <th>
                                @Resources.NubiHR.RequestDate
                            </th>
                            <th>
                                @Resources.NubiHR.TimeFrom
                            </th>

                            <th>
                                @Resources.NubiHR.TimeTo
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionDate
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionType
                            </th>

                            <th>
                                @Resources.NubiHR.Notes
                            </th>

                            @*<th>
                                @Resources.NubiHR.Status
                            </th>*@

                            <th>
                                @Resources.NubiHR.Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Where(e => e.IsDeleted == false && e.IsRejected == true).ToList())
                        {
                            <tr onclick="Edit('@item.Id')">
                                <td>
                                    @Html.DisplayFor(modelItem => item.Employee.FirstName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.RequestDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeFromHours) : @Html.DisplayFor(modelItem => item.TimeFromMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeToHours) : @Html.DisplayFor(modelItem => item.TimeToMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionType.Type)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.Note)
                                </td>

                                @*<td>
                                    @Html.DisplayFor(modelItem => item.IsRejected)
                                </td>*@

                                <td>
                                    @*@Html.ActionLink(Resources.NubiHR.Edit, "Edit", new { id = item.Id }) |*@
                                    @Html.ActionLink(Resources.NubiHR.Details, "Details", new { id = item.Id })
                                </td>
                            </tr>
                        }
                    </tbody>
                }
                else
                {
                    <thead>
                        <tr>
                            <th>
                                @Resources.NubiHR.EmployeeName
                            </th>
                            <th>
                                @Resources.NubiHR.RequestDate
                            </th>
                            <th>
                                @Resources.NubiHR.TimeFrom
                            </th>

                            <th>
                                @Resources.NubiHR.TimeTo
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionDate
                            </th>

                            <th>
                                @Resources.NubiHR.PermissionType
                            </th>

                            <th>
                                @Resources.NubiHR.Notes
                            </th>

                            <th>
                                @Resources.NubiHR.Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Where(e => e.IsDeleted == false && e.EmployeeNo == helperx.GetName(User.Identity.GetUserId()).Employee.Id && e.IsRejected == true).ToList())
                        {
                            <tr onclick="Edit('@item.Id')">
                                <td>
                                    @Html.DisplayFor(modelItem => item.Employee.FirstName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.RequestDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeFromHours) : @Html.DisplayFor(modelItem => item.TimeFromMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.TimeToHours) : @Html.DisplayFor(modelItem => item.TimeToMinutes)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PermissionType.Type)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.Note)
                                </td>

                                <td>
                                    @*@Html.ActionLink(Resources.NubiHR.Edit, "Edit", new { id = item.Id }) |*@
                                    @Html.ActionLink(Resources.NubiHR.Details, "Details", new { id = item.Id })
                                </td>
                            </tr>
                        }
                    </tbody>
                }
            }
        </table>
    </div>
</div>
    <script>
    function Edit(itemid) {

        window.location.href = "/PermissionRequest/Edit/" + itemid;
    }
</script>
@*<script type="text/javascript">
     $(document).ready(function () {
    var IsArabic = '@Request.Cookies["culture"].Value';
            IsArabic = (IsArabic === 'ar');
            $('#assets-data-table').DataTable({
                "language": {
                    "url": IsArabic ? "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Arabic.json" : "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/English.json"
                }
            });
     });
</script>*@